\documentclass{beamer}
\usepackage{algorithmic}
%\usetheme{Bergen}
%\usetheme{Copenhagen}
% \usetheme{Darmstadt}
% \usetheme{Frankfurt}
%\usetheme{Luebeck}
\usetheme{Madrid}
\usecolortheme{beetle}
%\usecolortheme{dove}
%\usecolortheme{fly}
%\usecolortheme{seagull}
%\useinnertheme{rectangles}
%\useinnertheme{circles}
%\useinnertheme{inmargin}
%\useinnertheme{rounded}
\include{cmds}
\title{What is \nowdb?}
\author{Tobias Schoofs}
\begin{document}

% TITLE
\frame{\titlepage}

% OVERVIEW 
\begin{frame}
\frametitle{Overview}
\begin{itemize}
\item What?
\item Why?
\item How?
\item Vision!
\item Market!
\item Where are we now?
\item Why the funny name?
\end{itemize}
\end{frame}

% WHAT
\begin{frame}
\frametitle{What?}
\begin{equation}
\nowdb = (graph +  timeseries + \acronym{sql}) \times (Python + Lua)
\end{equation}
\end{frame}

% WHY TIMESERIES
\begin{frame}[shrink]
\frametitle{Why Timeseries?}
\begin{itemize}
\item Always more data are timeseries \emph{to some extent}\\
      important driver: \acronym{i}o\acronym{t}\\
      but also: ``traditional'' industries:
      \begin{itemize} 
      \item energy,
      \item manufacturing
      \item retail
      \item \etc
      \end{itemize}
\item Avalailable timeseries databases are too narrow,\\
      \ie\ \emph{pure} timeseries data.\\
      There are projects trying to solve this issue,
      \eg:
      $timescale = postgres + timeseries$ \\
      $\dots$ but it's still a bit slow

\item Timeseries data have special requirements:
      \begin{itemize}
      \item Fast ingestion ($> 1M/s$)
      \item Scalability of queries ($> 1B metrics$)
      \item Special handling of time dimension
      \item Timeseries are less rigid
            (time points may be lost or duplicated)
      \end{itemize}
\end{itemize}
\end{frame}

% WHY GRAPH
\begin{frame}
\frametitle{Why Graph?}
\begin{itemize}
\item Make timeseries more widely applicable!
\item Natural candidates: Relational and Graph.
\item Graph is more flexible:\\
      one can add new edges without changing the structure of entities
\item Graph is less rigid:\\
      edges pointing to nowhere or\\
            pointing to duplicated data are no issue
\item Graph may be easier to grasp:\\
      and this way reduce common errors in data modelling.\\
      (This, however, is pure speculation on my side $\dots$)
\end{itemize}
\end{frame}

% WHY SQL
\begin{frame}
\frametitle{Why \acronym{sql}?}
\begin{itemize}
\item \st{Make }\acronym{\st{sql}}\st{ great again!}
\item \acronym{sql} is standard.
\item \acronym{sql} is actively developed with new ideas flowing in.
\item \acronym{sql} is known by virtually everybody in the industry.
\item \acronym{sql} is easy to learn (even though tricky to master \dots)
\item \acronym{sql} is designed for integration with other languages and tools.
\item \acronym{sql} is supported by thousands of tools.
\item \acronym{sql} is not bad anyway \dots
\item Well \dots
\item Next slide!
\end{itemize}
\end{frame}

% Why Python?
\begin{frame}[shrink]
\frametitle{Why Python?}
\includegraphics[width=0.2\linewidth]{pythonlogo.png}
\begin{itemize}
\item An important application domain for \nowdb\ is data science.
\item There will be strong demand for tools, libraries, languages supporting
\begin{itemize}
\item Calculus
\item Numerical analysis
\item Function analysis and function plotting
\item Linear Algebra (vectors, matrices, \etc)
\item Graph(!)-oriented data structures
\item Complex Analysis
\item \dots
\end{itemize}
\item Millions of lines of source code available in (or through) Python
\item Python is \textbf{the} data science language.\\
      (There also is $R$, but $R$ is very limited as general purpose language)
\item It is in particular interesting to have Python available
      on server side.
      This will reduce client/server round trips
      and network traffic.
\end{itemize}
\end{frame}

% Why Lua?
\begin{frame}[shrink]
\frametitle{Why Lua?}
\begin{columns}[T]
\column{0.9\linewidth}
\begin{itemize}
\item The main issue with Python (from our perspective):
      the design of the interpreter:
      \begin{itemize}
      \item difficult to run many interpreters ($=$sessions)
      \item in parallel in one process ($=$\nowdb\ server).
      \end{itemize}
\item In consequence:
      Python is not good for tasks that frequently run
      in parallel.
\item We therefore need a second language for more
      down-to-earth, day-to-day \acronym{dba} jobs.
\item Lua appears to be a good candidate because:
\begin{itemize}
\item Lua is well known in the data science community
\item Lua already had its appearance on the database stage\\
      (namely in the redis \term{in-memory} database).
\item Lua is designed as configuration language
\item Lua is designed for integration with the C language.
\end{itemize}
\end{itemize}
\column{0.18\linewidth}
%\begin{flushright}
\vskip5cm
\hskip-0.5\linewidth
\includegraphics[width=0.8\linewidth]{lualogo.png}
%\end{flushright}
\end{columns}
\end{frame}

% HOW
\ignore{
datamodel example with
simple edges:
- product of category or
- client has address
timeseries edges:
- client buys product
on joins
select client.buys.destin
}
\begin{frame}
\frametitle{How? Data Modelling}
\begin{columns}[T]
\column{0.33\linewidth}
\begin{center}
\vskip0.5cm
The Relational Way\\
\vskip2.5cm
\includegraphics[width=1.2\linewidth]{relational.png}
\end{center}
\column{0.33\linewidth}
\begin{center}
The Logical Fact\\[12pt]
\includegraphics[width=0.9\linewidth]{logic.png}
%\begin{tikzpicture}
%\draw [<->] (-3,0) -- (3,0);
%\end{tikzpicture}
\end{center}
\column{0.33\linewidth}
\begin{center}
\vskip0.5cm
The Graph Way\\
\vskip2.5cm
\hskip-0.2\linewidth
\includegraphics[width=1.2\linewidth]{graph.png}
\end{center}
\end{columns}
\end{frame}

% SQL Example
\begin{frame}[fragile]
\frametitle{How? \acronym{sql}}
\begin{columns}[T]
\column{0.4\linewidth}
\vskip0.5cm
{\small Create a vertex type}
\vskip1.7cm
{\small Create another vertex type}
\vskip1.2cm
{\small Add an edge \\without changing the types}
\column{0.5\linewidth}
\begin{sqlcode}
\begin{lstlisting}
create type supplier (
  id uint primary key,
  name text,
  ...
);
create type product (
  id uint primary key,
  description text,
  ...
);
create edge supplies (
  origin supplier,
  destin product
);
\end{lstlisting}
\end{sqlcode}
\end{columns}
\end{frame}

% Timeseries
\begin{frame}[fragile]
\frametitle{How? Timeseries}
\begin{columns}[T]
\column{0.4\linewidth}
\vskip0.5cm
{\small Product type}
\vskip1.7cm
{\small Client type}
\vskip1.7cm
{\small Timeseries edge}
\column{0.5\linewidth}
\begin{sqlcode}
\begin{lstlisting}
create type product (
  id uint primary key,
  description text,
  ...
);
create type client (
  id uint primary key,
  name text,
  ...
);
create edge buys (
  origin client,
  destin product,
  timestamp time,
  quantity float,
  price    float
);
\end{lstlisting}
\end{sqlcode}
\end{columns}
\end{frame}

% Query
\begin{frame}[fragile]
\frametitle{How? Queries}
\begin{columns}[T]
\column{0.25\linewidth}
\vskip0.5cm
{\small Who bought product 12345?}
{\small This query runs in milliseconds!}
\vskip0.7cm
{\small Traditional Join}
\vskip1.9cm
{\small Implicit join}
\column{0.75\linewidth}
\begin{sqlcode}
\begin{lstlisting}
select origin
  from buys
 where destin = 12345
   and year(stamp) = 2018
   and month(stamp) >= 10;

select p.supplier
  from buys (join product as p on destin)
            (join client  as c on origin)
 where c.name = 'Smith'
   and year(stamp) = 2018;

select destin.supplier
  from buys
 where origin.name = 'Smith'
   and year(stamp) = 2018;
\end{lstlisting}
\end{sqlcode}
\end{columns}
\end{frame}

% Storage engine
\begin{frame}
\frametitle{How? Storage Engine (1/2)}
Two storage types:
\begin{enumerate}
\item Edge Store:
      \begin{itemize}
      \item optimised for fast ingestion
      \item data packed to favour typical queries
      \item special handling of timestamps
      \item small memory footprint
      \item optional compression
            (recommended for timeseries edges)
      \end{itemize}
\item Vertex Store:
      \begin{itemize}
      \item consistent data (no duplicates)
      \item column-oriented
            (\ie\ optimised for large data types)
      \item enforce primary key
      \item in-memory caches to speed up
            inserts and queries
      \item optional compression
            (recommended only for large tables)
      \end{itemize}
\end{enumerate}
\end{frame}

\begin{frame}
\frametitle{How? Storage Engine (2/2)}
Four index types:
\begin{enumerate}
\item Primary Keys (Vertex)
      \begin{itemize}
      \item B$^+$Tree
      \item storing set of \term{pageids}
      \end{itemize}
\item Secondary Vertex Index
      \begin{itemize}
      \item B$^+$Tree
      \item storing set of primary keys
      \end{itemize}
\item Page Index (Edge):
      \begin{itemize}
      \item B$^+$Tree
      \item storing ``embedded'' B$^+$Trees
            pointing to data pages
      \item used for queries and joins on edges
      \end{itemize}
\item Label Index (Edge):
      \begin{itemize}
      \item B$^+$Tree
      \item storing fixed number of pageids
      \item used to find related edges
      \end{itemize}
\end{enumerate}
\end{frame}

% VISION
\begin{frame}[shrink]
\frametitle{Vision!}
\begin{itemize}
\item \textbf{Scalability!}\\
      Reduce hardware and software license cost
      by allowing more data to be stored on one node,
      \ie\ billions of metrics per server.
\item \textbf{Data Analysis}\\
      Provide server- and client-side Python modules
      to ease data science.
\item \textbf{Integration with big-data tools}\\
      Ease big-data by integration with existing tools
      \eg\ Kafka for reliable ingestion of data.
\item \textbf{Integration with distribution engines}\\
      Ease large-scale computation by integration with existing tools
      \eg\ \acronym{spark} for distributed computing.
\item \textbf{Integration with visualisation frameworks}\\
      Ease application development by integration with existing
      \acronym{gui} frameworks, \eg\ Grafana.
\item \textbf{Integration with traditional tools}\\
      Use \acronym{odbc/jdbc} to make the platform available
      to traditional tools.
\item \textbf{Publish/Subscribe Capability}\\
      Provide pub/sub capability to ease the development
      of monitoring and real-time data analysis.
\end{itemize}
\end{frame}

% MARKET
\begin{frame}
\frametitle{Market!}
\begin{itemize}
\item \textbf{Complement} existing \acronym{oltp} infrastructures
\item \textbf{Compete} with complex big-data and data science platforms
      providing a low-cost alternative 
      to frameworks with high cost of ownership
      (\eg: Hadoop, large \acronym{olap} systems, \etc)
\item Target industries with partly timeseries data 
      and need of data science
      (\eg\ \acronym{i}o\acronym{t}, retail, fintech, ``industry 4.0'')
\item Provide pre-packaged out-of-the-box solutions
      (\eg\ integration with Kafka, Zookeeper, \acronym{spark} \& Grafana)
\item Operate with a mix of open-source and proprietary licenses
      (\eg\ generic modules for free, specific modules for pay)
\item Foster a community among customers to grow repository of
      available solutions and modules
\end{itemize}
\end{frame}

% WHERE ARE WE NOW 
\begin{frame}[shrink]
\frametitle{Where are we now?}
\begin{itemize}
\item Prototype is available:
      \bgroup
      \setbeamercolor{item}{fg=green}
      \begin{itemize}
      \item Client/Server
      \item \acronym{sql} with many operators and functions:
            \begin{itemize}
            \item arithmetic and boolean operators and functions,
            \item \acronym{case} and other conditionals,
            \item time and geospatial functions,
            \item trigonometry,
            \item string operators and functions,
            \item \dots
            \end{itemize}
      \item Python client- and server-side
      \item Simple command line client
      \setbeamercolor{item}{fg=yellow}
      \item First iteration of Grafana plug-in
      \item Foundations for grouping, ordering and joins
      \item Storage engine needs revision
      \item User manual on the way
      \setbeamercolor{item}{fg=red}
      \item Query planner still rudimentary
      \item Todo: security and user management
      \end{itemize}
      \egroup
\item We are currently working with the \acronym{i}o\acronym{t}
      startup \term{Loka Systems} (\url{https://loka.systems})
      to identify strengths and weaknesses.
\end{itemize}
\end{frame}

% NORBERT WIENER
\begin{frame}
\frametitle{The funny Name}
\begin{columns}[T]
\column{0.4\linewidth}
\begin{itemize}
\item a pun on \term{no}- and \term{new}\acronym{sql}
\item a reference to time
\item \dots and a homage to Norbert Wiener,\\
      the father of \\ timeseries analysis \\
      for Control \& Communication
\end{itemize}
\column{0.6\linewidth}
\includegraphics[width=\linewidth]{wiener.jpeg}
\end{columns}
\end{frame}
\end{document}
