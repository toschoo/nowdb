refactor fetch
--------------
refactor fetch, so it's easier to adapt for join
