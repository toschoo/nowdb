group-by review
===============
make group-by applicable for all cases
